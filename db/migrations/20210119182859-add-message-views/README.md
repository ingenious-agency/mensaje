# Migration `20210119182859-add-message-views`

This migration has been generated by Gabriel Chertok at 1/19/2021, 3:28:59 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "MessageView" (
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,
    "userId" TEXT NOT NULL,
    "messageId" TEXT NOT NULL,

    PRIMARY KEY ("userId","messageId")
)

ALTER TABLE "MessageView" ADD FOREIGN KEY("userId")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "MessageView" ADD FOREIGN KEY("messageId")REFERENCES "Message"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210118133622-add-installation-info-to-user..20210119182859-add-message-views
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -51,8 +51,9 @@
   userId         String?
   slackChannelId String
   reactions      Reaction[]
   slackTimeStamp String?
+  views          MessageView[]
 }
 model Reaction {
   id        String   @id @default(uuid())
@@ -64,4 +65,14 @@
   userId    String?
   message   Message? @relation(fields: [messageId], references: [id])
   messageId String?
 }
+
+model MessageView {
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  userId    String
+  user      User     @relation(fields: [userId], references: [id])
+  messageId String
+  message   Message  @relation(fields: [messageId], references: [id])
+  @@id([userId, messageId])
+}
```


